<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Classements Smash Betting</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f4f4f9; display: flex; justify-content: center; gap: 40px; }
        .classement-box { width: 45%; max-width: 600px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h2 { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 5px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #f2f2f2; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .rank-1 { background-color: gold !important; font-weight: bold; }
        .rank-2 { background-color: silver !important; font-weight: bold; }
        .rank-3 { background-color: #cd7f32 !important; color: white; font-weight: bold; }
    </style>
</head>
<body>

    <div class="classement-box">
        <h2>üèÜ Classement G√©n√©ral des Points</h2>
        <table id="classement-points">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Utilisateur</th>
                    <th>Points</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <div class="classement-box">
        <h2>‚ú® Top Bonus Utilis√©s</h2>
        <table id="classement-bonus">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Utilisateur</th>
                    <th>Bonus Utilis√©s</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <script>
        const apiBaseUrl = window.location.origin;

        function fetchAndDisplayClassement(endpoint, tableId, valueKey, valueLabel) {
            fetch(`${apiBaseUrl}/api/classement/${endpoint}`)
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.getElementById(tableId).querySelector('tbody');
                    tableBody.innerHTML = '';

                    data.forEach((item, index) => {
                        const row = tableBody.insertRow();
                        const rank = index + 1;
                        
                        // Style pour les 3 premi√®res places
                        if (rank === 1) row.className = 'rank-1';
                        if (rank === 2) row.className = 'rank-2';
                        if (rank === 3) row.className = 'rank-3';

                        row.insertCell().textContent = rank;
                        row.insertCell().textContent = item.username;
                        row.insertCell().textContent = item[valueKey];
                    });
                })
                .catch(error => {
                    console.error(`Erreur lors du chargement du classement ${endpoint}:`, error);
                    document.getElementById(tableId).querySelector('tbody').innerHTML = 
                        `<tr><td colspan="3">Erreur de chargement du classement.</td></tr>`;
                });
        }

        function refreshClassements() {
            fetchAndDisplayClassement('points', 'classement-points', 'totalPoints', 'Points');
            fetchAndDisplayClassement('bonus', 'classement-bonus', 'bonusUsedCount', 'Bonus Utilis√©s');
        }

        document.addEventListener('DOMContentLoaded', refreshClassements);
        
        // Rafra√Æchissement automatique toutes les 30 secondes
        setInterval(refreshClassements, 30000); 
    </script>

</body>
</html>